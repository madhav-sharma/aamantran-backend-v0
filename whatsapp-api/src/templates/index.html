<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Wedding RSVP Management</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <style>
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background: #f3f3f3; }
        .error { color: red; margin-bottom: 1em; }
        input[type="text"], input[type="checkbox"] { width: 100%; }
    </style>
</head>
<body>
    <h1>Wedding RSVP Guest List</h1>
    {% if error %}<div class="error">{{ error }}</div>{% endif %}
    <form method="post" action="/send-invites" style="margin-bottom: 1em;">
        <button type="submit">Send Invites</button>
    </form>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Greeting Name</th>
                <th>Phone</th>
                <th>Group ID</th>
                <th>Is Primary</th>
                <th>Ready</th>
                <th>Sent to WA</th>
                <th>Sent At</th>
                <th>Delivered At</th>
                <th>Read At</th>
                <th>Message ID</th>
            </tr>
        </thead>
        <tbody>
            {% for g in guests %}
            <tr>
                <td>{{ g.id }}</td>
                <td>{{ g.first_name }}</td>
                <td>{{ g.last_name }}</td>
                <td>{{ g.greeting_name or '' }}</td>
                <td>{{ g.phone or '' }}</td>
                <td>{{ g.group_id }}</td>
                <td><input type="checkbox" {% if g.is_group_primary %}checked{% endif %} disabled></td>
                <td><input type="checkbox" {% if g.ready %}checked{% endif %} disabled></td>
                <td>{{ g.sent_to_whatsapp }}</td>
                <td>{{ g.sent_at if g.sent_at else 'N/A' }}</td>
                <td>{{ g.delivered_at if g.delivered_at else 'N/A' }}</td>
                <td>{{ g.read_at if g.read_at else 'N/A' }}</td>
                <td>{{ g.message_id or '' }}</td>
            </tr>
            {% endfor %}
            <tr>
                <form method="post" action="/add-guest">
                    <td></td>
                    <td><input name="first_name" type="text" required></td>
                    <td><input name="last_name" type="text" required></td>
                    <td><input name="greeting_name" type="text"></td>
                    <td><input name="phone" type="text"></td>
                    <td><input name="group_id" type="text" required></td>
                    <td style="text-align:center"><input name="is_group_primary" type="checkbox" value="true"></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td><button type="submit">Add Guest</button></td>
                </form>
            </tr>
        </tbody>
    </table>
</body>
</html>